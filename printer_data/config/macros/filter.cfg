[gcode_macro _FILTER_OFF]
gcode:
    {% set vars = printer['gcode_macro _USER_VARIABLES'] %}
    {% set fan = vars.filter_fan %}

    SET_FAN_SPEED FAN={fan} SPEED=0

[gcode_macro _FILTER_SLOW]
gcode:
    {% set vars = printer['gcode_macro _USER_VARIABLES'] %}
    {% set fan = vars.filter_fan %}
    {% set speed = vars.speed_slow %}

    SET_FAN_SPEED FAN={fan} SPEED={speed}

[gcode_macro _FILTER_SLOW]
gcode:
    {% set vars = printer['gcode_macro _USER_VARIABLES'] %}
    {% set fan = vars.filter_fan %}
    {% set speed = vars.speed_fast %}

    SET_FAN_SPEED FAN={fan} SPEED={speed}
